<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>Kniffen's space</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Kniffen&amp;#39;s space on the internet"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i"><link rel="preload" href="/_nuxt/b207b408d65d965fd5c4.js" as="script"><link rel="preload" href="/_nuxt/b351a7f9d14b8302c515.js" as="script"><link rel="preload" href="/_nuxt/c1df056b19a384c11191.js" as="script"><link rel="preload" href="/_nuxt/6623d30d119dfedba551.js" as="script"><link rel="preload" href="/_nuxt/0579ee73370eaf273b6e.js" as="script"><style data-vue-ssr-id="4cb2c460:0 3191d5ad:0 19be4cd8:0 57b6cdfe:0 d8f175f0:0">:root{--font-family:"Roboto",sans-serif;--font-size:16px;--color-bg:#0a0600;--color-bg-2:#272822;--color-text:#0a0600;--color-text-2:#f7fff1;--color-text-3:#e1ffeb;--color-anchor:#378699;--color-border:#e1ffeb;--spacing:10px;font-size:16px;font-size:var(--font-size)}*{margin:0;padding:0}body{font-family:Roboto,sans-serif;font-family:var(--font-family);color:#0a0600;color:var(--color-text);word-wrap:break-word}h1,h2,h3,h4,h5,h6{text-transform:uppercase;margin:.5em 0}h1{font-size:3.5rem}h2{font-size:2rem}p{line-height:1.5em}a{color:#378699;color:var(--color-anchor)}a:hover{text-decoration:none}img{max-width:100%;height:auto}.listings{display:grid;grid-gap:10px;grid-gap:var(--spacing);align-content:start}.listing{position:relative;display:grid;color:#e1ffeb;color:var(--color-text-3)}.listing-title{background-color:rgba(10,10,0,.5);position:absolute;opacity:0;display:grid;align-content:center;-webkit-box-pack:center;justify-content:center;height:100%;width:100%;text-align:center;-webkit-transition:opacity .3s ease-in-out;transition:opacity .3s ease-in-out}.listing-title h2{margin:0}.listing-thumbnail{background-color:#0a0600;background-color:var(--color-bg);display:grid;align-content:center}.listing:hover .listing-title{opacity:1}@media (min-width:768px){:root{--spacing:20px}h1{font-size:5rem}h2{font-size:3rem}.listings{grid-template-columns:repeat(2,1fr)}}@-webkit-keyframes glitchHorizontal{0%{left:1px}3.33333%{left:1px}6.66667%{left:2px}10%{left:2px}13.33333%{left:1px}16.66667%{left:1px}20%{left:0}23.33333%{left:2px}26.66667%{left:1px}30%{left:0}33.33333%{left:1px}36.66667%{left:0}40%{left:1px}43.33333%{left:0}46.66667%{left:0}50%{left:0}53.33333%{left:1px}56.66667%{left:1px}60%{left:0}63.33333%{left:1px}66.66667%{left:2px}70%{left:1px}73.33333%{left:2px}76.66667%{left:2px}80%{left:1px}83.33333%{left:1px}86.66667%{left:2px}90%{left:1px}93.33333%{left:2px}96.66667%{left:1px}to{left:1px}}@keyframes glitchHorizontal{0%{left:1px}3.33333%{left:1px}6.66667%{left:2px}10%{left:2px}13.33333%{left:1px}16.66667%{left:1px}20%{left:0}23.33333%{left:2px}26.66667%{left:1px}30%{left:0}33.33333%{left:1px}36.66667%{left:0}40%{left:1px}43.33333%{left:0}46.66667%{left:0}50%{left:0}53.33333%{left:1px}56.66667%{left:1px}60%{left:0}63.33333%{left:1px}66.66667%{left:2px}70%{left:1px}73.33333%{left:2px}76.66667%{left:2px}80%{left:1px}83.33333%{left:1px}86.66667%{left:2px}90%{left:1px}93.33333%{left:2px}96.66667%{left:1px}to{left:1px}}@-webkit-keyframes glitchVertical{0%{top:1px}3.33333%{top:3px}6.66667%{top:1px}10%{top:2px}13.33333%{top:4px}16.66667%{top:0}20%{top:1px}23.33333%{top:1px}26.66667%{top:3px}30%{top:2px}33.33333%{top:3px}36.66667%{top:0}40%{top:1px}43.33333%{top:1px}46.66667%{top:0}50%{top:2px}53.33333%{top:3px}56.66667%{top:0}60%{top:2px}63.33333%{top:2px}66.66667%{top:3px}70%{top:0}73.33333%{top:0}76.66667%{top:3px}80%{top:3px}83.33333%{top:2px}86.66667%{top:2px}90%{top:1px}93.33333%{top:0}96.66667%{top:1px}to{top:1px}}@keyframes glitchVertical{0%{top:1px}3.33333%{top:3px}6.66667%{top:1px}10%{top:2px}13.33333%{top:4px}16.66667%{top:0}20%{top:1px}23.33333%{top:1px}26.66667%{top:3px}30%{top:2px}33.33333%{top:3px}36.66667%{top:0}40%{top:1px}43.33333%{top:1px}46.66667%{top:0}50%{top:2px}53.33333%{top:3px}56.66667%{top:0}60%{top:2px}63.33333%{top:2px}66.66667%{top:3px}70%{top:0}73.33333%{top:0}76.66667%{top:3px}80%{top:3px}83.33333%{top:2px}86.66667%{top:2px}90%{top:1px}93.33333%{top:0}96.66667%{top:1px}to{top:1px}}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;-webkit-transition:width .1s,opacity .4s;transition:width .1s,opacity .4s;background-color:#fff;z-index:999999}.nuxt-progress.nuxt-progress-notransition{-webkit-transition:none;transition:none}.nuxt-progress-failed{background-color:red}.site-header[data-v-3fb495f1]{position:fixed;top:0;background:var(--color-bg);width:calc(100% - var(--spacing)*2);display:grid;padding:var(--spacing);grid-template-columns:minmax(0,1fr) 50px;z-index:100}.logo[data-v-3fb495f1]{height:20px;align-self:center}.logo img[data-v-3fb495f1]{height:100%;width:auto}main[data-v-3fb495f1]{display:grid;margin-top:calc(35px + var(--spacing)*2);padding:var(--spacing);min-height:100vh;align-content:start;grid-template-rows:minmax(0,auto) minmax(0,1fr) minmax(0,auto);grid-template-columns:minmax(0,100%)}.content-header[data-v-3fb495f1]{text-align:center}@media (min-width:1200px){main[data-v-3fb495f1]{max-width:1200px;margin-right:auto;margin-left:auto}}.site-nav[data-v-55affc7c]{position:relative;justify-self:end}#site-nav-toggle[data-v-55affc7c]{display:none}#site-nav-toggle-label[data-v-55affc7c]{position:relative;display:block;width:35px;height:35px;cursor:pointer;overflow:hidden;right:0}#site-nav-toggle-label span[data-v-55affc7c],#site-nav-toggle-label span[data-v-55affc7c]:after,#site-nav-toggle-label span[data-v-55affc7c]:before{background-color:var(--color-border);position:absolute;display:block;width:100%;height:2px;-webkit-transition:.3s ease-in-out;transition:.3s ease-in-out}#site-nav-toggle-label span[data-v-55affc7c]{top:-1px;bottom:0;margin:auto;width:60%;right:0}#site-nav-toggle-label span[data-v-55affc7c]:after,#site-nav-toggle-label span[data-v-55affc7c]:before{content:""}#site-nav-toggle-label span[data-v-55affc7c]:before{width:140%;top:-8px;left:-14px}#site-nav-toggle-label span[data-v-55affc7c]:after{width:120%;bottom:-8px;left:-12px}#site-nav-toggle-label:hover span[data-v-55affc7c]{width:100%}#site-nav-toggle-label:hover span[data-v-55affc7c]:after,#site-nav-toggle-label:hover span[data-v-55affc7c]:before{width:100%;left:0}nav[data-v-55affc7c]{position:absolute;background-color:var(--color-bg);margin-top:calc(var(--spacing)*.5);padding:calc(var(--spacing)*.5);text-align:right;text-transform:uppercase;font-size:1.2rem;overflow:hidden;display:grid;grid-gap:calc(var(--spacing)*.5);-webkit-transition:right .5s ease-in-out;transition:right .5s ease-in-out;right:-2000px}nav>[data-v-55affc7c]{color:var(--color-text-3);-webkit-transition:right .3s ease-in-out;transition:right .3s ease-in-out}nav>[data-v-55affc7c],nav[data-v-55affc7c]>:hover{text-decoration:none}nav[data-v-55affc7c]>:hover{-webkit-animation:glitchHorizontal 2s linear infinite;animation:glitchHorizontal 2s linear infinite}#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c],#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:after,#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:before{width:100%}#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]{height:0}#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:after,#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:before{top:0;width:35px;left:0}#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}#site-nav-toggle:checked~#site-nav-toggle-label span[data-v-55affc7c]:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}#site-nav-toggle:checked~nav[data-v-55affc7c]{right:calc(var(--spacing)*-1)}.site-footer[data-v-719209e1]{padding:var(--spacing);text-align:center;font-size:.75rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="wrapper" data-v-3fb495f1><header class="site-header" data-v-3fb495f1><a href="/" class="logo" data-v-3fb495f1><img src="/images/logo.svg" data-v-3fb495f1></a> <div class="site-nav" data-v-55affc7c data-v-3fb495f1><input type="checkbox" id="site-nav-toggle" data-v-55affc7c> <label for="site-nav-toggle" id="site-nav-toggle-label" data-v-55affc7c><span data-v-55affc7c></span></label> <nav data-v-55affc7c><a href="/" data-v-55affc7c>Home</a> <a href="/projects" data-v-55affc7c>Projects</a> <a href="/art" data-v-55affc7c>Art</a> <a href="/about" data-v-55affc7c>About</a></nav></div></header> <main data-v-3fb495f1><header class="content-header" data-v-3fb495f1><h1 data-v-3fb495f1>Dream Cheeky USB WebMail Notifier</h1></header> <section data-v-3fb495f1><p>Years ago I bought this silly device thinking it would be a neat gadget to have in the office, however as with most of there things it got used for a little bit and then stored away.<br>
Then one day I was browsing the internet and found this <a href="https://www.instructables.com/id/Hack-a-cheap-usb-gadget-into-a-Color-Changing-Crys/">instructables</a> article showing someone had turned it into a glowing rock, and I thought I could probably do something similar.<br>
Through the article I found a <a href="https://github.com/gbrayut/dreamcheekyusb">repository</a> of an open source driver written in C# for the device, even though I would be using JavaScript it did provide various HEX sequences I needed in order to talk to the device.<br> <br></p> <p>But first off I needed to get the <strong>vendorID</strong> and <strong>productID</strong> of the device, this can be accomplished by using the <a href="https://github.com/tessel/node-usb">node-usb</a> library and plugging in the device, then reading the data.</p> <pre><code class="language-JS"><span class="hljs-keyword">const</span> usb = <span class="hljs-built_in">require</span>(<span class="hljs-string">'usb'</span>)

usb.on(<span class="hljs-string">'attach'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">device</span>) </span>{
  <span class="hljs-built_in">console</span>.log(device)
})
</code></pre> <p>And what we get is something like this.</p> <pre><code class="language-JSON">Device {
  busNumber: <span class="hljs-number">2</span>,
  deviceAddress: <span class="hljs-number">3</span>,
  deviceDescriptor:
   { bLength: <span class="hljs-number">18</span>,
     bDescriptorType: <span class="hljs-number">1</span>,
     bcdUSB: <span class="hljs-number">272</span>,
     bDeviceClass: <span class="hljs-number">0</span>,
     bDeviceSubClass: <span class="hljs-number">0</span>,
     bDeviceProtocol: <span class="hljs-number">0</span>,
     bMaxPacketSize0: <span class="hljs-number">8</span>,
     idVendor: <span class="hljs-number">7476</span>,
     idProduct: <span class="hljs-number">4</span>,
     bcdDevice: <span class="hljs-number">2</span>,
     iManufacturer: <span class="hljs-number">1</span>,
     iProduct: <span class="hljs-number">2</span>,
     iSerialNumber: <span class="hljs-number">0</span>,
     bNumConfigurations: <span class="hljs-number">1</span> },
  portNumbers: [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span> ] }
</code></pre> <p>As we can tell by the data the <strong>vendorID</strong> is <em>7476</em> and the <strong>productID</strong> is <em>4</em>.
<br> <br></p> <p>Now that I knew the <strong>vendorID</strong> and <strong>productID</strong> of the device I could easily tap into it and transfer data.<br>
The initialization sequences seem to be needed to ensure that the device works when connecting it, there was also 4 of them but the first one worked for me.<br>
You may need to try one of the other ones if you're doing this yourself.<br>
The color sequence seems to be three RGB values followed by 5 other HEX values, I'm still not sure about the significance of these values.</p> <pre><code class="language-JS"><span class="hljs-keyword">const</span> usb = <span class="hljs-built_in">require</span>(<span class="hljs-string">'usb'</span>)

<span class="hljs-keyword">const</span> vendorID = <span class="hljs-string">'7476'</span>
<span class="hljs-keyword">const</span> productID = <span class="hljs-string">'4'</span>

<span class="hljs-comment">// Initialization sequences</span>
<span class="hljs-keyword">const</span> init01 = [<span class="hljs-number">0x1F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x03</span>]
<span class="hljs-keyword">const</span> init02 = [<span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x04</span>]
<span class="hljs-keyword">const</span> init03 = [<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x05</span>]
<span class="hljs-keyword">const</span> init04 = [<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>]

<span class="hljs-comment">// Find device as application start in case it's already connected</span>
<span class="hljs-keyword">let</span> webmailNotifier = usb.findByIds(vendorID, productID)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initiate</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> initBuffer = <span class="hljs-keyword">new</span> Buffer.from(init01)

  webmailNotifier.open()

  <span class="hljs-comment">// Initial transfer, needed to make the device accessible</span>
  webmailNotifier.controlTransfer(<span class="hljs-number">0x21</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x200</span>, <span class="hljs-number">0x0</span>, initBuffer, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)

    <span class="hljs-comment">// Turn LED off</span>
    changeColor([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>])

    <span class="hljs-comment">// Set color to red</span>
    changeColor([<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>])
  })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeColor</span>(<span class="hljs-params">rgb</span>) </span>{
  <span class="hljs-keyword">const</span> colorBuffer = Buffer.from(rgb.concat([<span class="hljs-number">0xFF</span>,<span class="hljs-number">0xFF</span>,<span class="hljs-number">0xFF</span>,<span class="hljs-number">0x1F</span>,<span class="hljs-number">0x05</span>]))
  webmailNotifier.controlTransfer(<span class="hljs-number">0x21</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x200</span>, <span class="hljs-number">0x0</span>, colorBuffer)
}

<span class="hljs-keyword">if</span> (webmailNotifier) {
  initiate()
}

<span class="hljs-comment">// Initiate device when it connects to the computer</span>
usb.on(<span class="hljs-string">'attach'</span>, device => {
  <span class="hljs-keyword">if</span> (device.deviceDescriptor.idVendor == vendorID && device.deviceDescriptor.idProduct == productID) {
    webmailNotifier = device
    initiate()
  }
})

<span class="hljs-comment">// Close and remove the device when it disconnects from the computer</span>
usb.on(<span class="hljs-string">'detach'</span>, device => {
  <span class="hljs-keyword">if</span> (device.deviceDescriptor.idVendor == vendorID && device.deviceDescriptor.idProduct == productID) {
    device.close()
    webmailNotifier = <span class="hljs-literal">undefined</span>
  }
})
</code></pre> <br> <p>Here's a small demo application I made to demonstrate what you might be able to do with the device, if you're interested the source code is available on <a href="https://github.com/kniffen/Dream-Cheeky-USB-WebMail-Notifier">GitHub</a></p> <p><img src="/images/projects/dream-cheeky-usb-webmail-notifier/demo.gif" alt="demo gif"></p> <p><strong>Credits</strong><br> <a href="https://www.instructables.com/id/Hack-a-cheap-usb-gadget-into-a-Color-Changing-Crys/">Instructables</a><br> <a href="https://archive.codeplex.com/?p=dreamcheekyusb">codeplex</a></p></section> <footer class="site-footer" data-v-719209e1 data-v-3fb495f1>Copyright © Kniffen 2019</footer></main></div></div></div><script>window.__NUXT__={layout:"default",data:[{}],error:null,serverRendered:!0}</script><script src="/_nuxt/b207b408d65d965fd5c4.js" defer></script><script src="/_nuxt/0579ee73370eaf273b6e.js" defer></script><script src="/_nuxt/b351a7f9d14b8302c515.js" defer></script><script src="/_nuxt/c1df056b19a384c11191.js" defer></script><script src="/_nuxt/6623d30d119dfedba551.js" defer></script>
  </body>
</html>
